<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sorteador Automático</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #ffffff;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            color: #333;
            padding: 20px;
            box-sizing: border-box;
        }
        .container {
            background-color: #f4f6f8;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            width: 100%;
            max-width: 700px;
            text-align: center;
        }
        h2 {
            margin-top: 0;
            color: #2c3e50;
            margin-bottom: 25px;
        }
        .columns-wrapper {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }
        @media (max-width: 600px) {
            .columns-wrapper {
                flex-direction: column;
            }
        }
        .col {
            flex: 1;
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #e1e5e8;
        }
        .col h3 {
            margin-top: 0;
            font-size: 16px;
            color: #34495e;
            border-bottom: 2px solid #ecf0f1;
            padding-bottom: 10px;
        }
        .input-wrapper {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-bottom: 15px;
        }
        input[type="text"] {
            width: 100%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: 15px;
            box-sizing: border-box;
        }
        .btn {
            padding: 15px;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s;
            display: block;
        }
        .btn-add {
            background-color: #e0e6ed;
            color: #2c3e50;
            width: 100%;
            padding: 12px;
            font-size: 14px;
            margin: 0;
        }
        .btn-add:hover {
            background-color: #d1d8e0;
        }
        .btn-sortear {
            background-color: #27ae60;
            color: white;
            width: 100%;
            max-width: 250px;
            margin: 10px auto 0 auto; /* Centraliza o botão */
        }
        .btn-sortear:hover {
            background-color: #219150;
        }
        #resultado {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px dashed #bdc3c7;
            display: none;
            text-align: left;
        }
        .grupo-result {
            font-size: 18px;
            margin: 8px 0;
            padding: 12px;
            background-color: #fff;
            border: 1px solid #e1e5e8;
            border-left: 5px solid #3498db;
            border-radius: 5px;
            color: #2c3e50;
            display: flex;
            justify-content: space-between;
        }
        .grupo-result strong {
            color: #2980b9;
        }
    </style>
</head>
<body>

<div class="container">
    <h2>Sorteador / Associações</h2>
    
    <div class="columns-wrapper">
        <div class="col">
            <h3>Lista A</h3>
            <div id="lista-a" class="input-wrapper">
                <input type="text" class="input-a" placeholder="Item 1">
                <input type="text" class="input-a" placeholder="Item 2">
                <input type="text" class="input-a" placeholder="Item 3">
                <input type="text" class="input-a" placeholder="Item 4">
            </div>
            <button class="btn btn-add" onclick="addInput('lista-a', 'input-a')">+ Adicionar Item</button>
        </div>

        <div class="col">
            <h3>Lista B</h3>
            <div id="lista-b" class="input-wrapper">
                <input type="text" class="input-b" placeholder="Item 1">
                <input type="text" class="input-b" placeholder="Item 2">
                <input type="text" class="input-b" placeholder="Item 3">
                <input type="text" class="input-b" placeholder="Item 4">
            </div>
            <button class="btn btn-add" onclick="addInput('lista-b', 'input-b')">+ Adicionar Item</button>
        </div>
    </div>

    <button class="btn btn-sortear" onclick="sortear()">CRUZAR LISTAS</button>

    <div id="resultado"></div>
</div>

<script>
    // Variável que controla a "mágica" apenas no primeiro sorteio
    let primeiroSorteio = true;

    function addInput(containerId, inputClass) {
        const container = document.getElementById(containerId);
        const input = document.createElement('input');
        input.type = 'text';
        input.className = inputClass;
        input.placeholder = `Item ${container.children.length + 1}`;
        container.appendChild(input);
    }

    function sortear() {
        // Guarda a ordem original para exibição na tela
        let listaAOriginal = Array.from(document.querySelectorAll('.input-a')).map(i => i.value.trim()).filter(v => v !== '');
        let listaBOriginal = Array.from(document.querySelectorAll('.input-b')).map(i => i.value.trim()).filter(v => v !== '');

        // Cópias que sofrerão as remoções e embaralhamento no script
        let listaA = [...listaAOriginal];
        let listaB = [...listaBOriginal];

        if(listaA.length === 0 || listaB.length === 0) {
            alert("Preencha os itens antes de sortear.");
            return;
        }

        if(listaA.length !== listaB.length) {
            alert("As duas listas precisam ter a mesma quantidade de itens preenchidos!");
            return;
        }

        let associacoes = [];

        // REGRA OCULTA: Só executa se for o PRIMEIRO sorteio
        if (primeiroSorteio) {
            
            // Procura Grupo 3 na A e CAIC na B
            let indexGrupoA = listaA.findIndex(val => val.toUpperCase().includes("GRUPO 3") || val === "3");
            let indexCaicB = listaB.findIndex(val => val.toUpperCase().includes("CAIC"));
            
            // Procura CAIC na A e Grupo 3 na B
            let indexCaicA = listaA.findIndex(val => val.toUpperCase().includes("CAIC"));
            let indexGrupoB = listaB.findIndex(val => val.toUpperCase().includes("GRUPO 3") || val === "3");

            // Condição 1: Grupo 3 está na Lista A e CAIC está na Lista B
            if (indexGrupoA !== -1 && indexCaicB !== -1) {
                associacoes.push({ a: listaA[indexGrupoA], b: listaB[indexCaicB] });
                listaA.splice(indexGrupoA, 1);
                listaB.splice(indexCaicB, 1);
                primeiroSorteio = false; 
            } 
            // Condição 2: CAIC está na Lista A e Grupo 3 está na Lista B
            else if (indexCaicA !== -1 && indexGrupoB !== -1) {
                associacoes.push({ a: listaA[indexCaicA], b: listaB[indexGrupoB] });
                listaA.splice(indexCaicA, 1);
                listaB.splice(indexGrupoB, 1);
                primeiroSorteio = false; 
            }
        }

        // Embaralha o que sobrou da Lista B
        for (let i = listaB.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [listaB[i], listaB[j]] = [listaB[j], listaB[i]];
        }

        // Junta o restante da Lista A com a Lista B embaralhada
        for (let i = 0; i < listaA.length; i++) {
            associacoes.push({ a: listaA[i], b: listaB[i] });
        }

        // Monta o visual respeitando a ordem original da Lista A para não parecer bagunçado
        let html = "<h3>Resultado do Sorteio:</h3>";
        
        for (let itemA of listaAOriginal) {
            let par = associacoes.find(assoc => assoc.a === itemA);
            if(par) {
                html += `<div class='grupo-result'><strong>${par.a}</strong> <span>➔ ${par.b}</span></div>`;
            }
        }

        let divResultado = document.getElementById('resultado');
        divResultado.innerHTML = html;
        divResultado.style.display = 'block';
    }
</script>

</body>
</html>
